const width_threshold = 480; var defaultOrientation = 0; window.addEventListener("orientationchange", function () { location.reload() }, !1); const getPolynomialRegression = (o, t) => { t = t || 2; let a = []; return regression("polynomial", o, t).points.forEach(o => a.push(Math.ceil(100 * o[1]) / 100)), a }, getExponentialRegression = o => { let t = []; o.forEach((o, a) => t.push([a + 1, o])); let a = []; return regression("exponential", t).points.forEach(o => a.push(Math.ceil(100 * o[1]) / 100)), a }; function getData() { let o = [], t = [], a = [], e = [], n = [], i = [], s = [], l = [], r = []; $.ajax({ type: "GET", url: "/boletim", success: function (d) { let c = [], b = d.length; for (let h = 0; h < b; h++)c = d[h], o.push(ajusteDataHora(c.data)), t.push(c.novosCasos), a.push(c.totalCasos), e.push(c.novosObitos), n.push(c.totalObitos), i.push(c.novosSrag), s.push(c.totalSrag), l.push([h, c.novosCasos]), 0 === c.novosCasos ? r.push(.1) : r.push(c.totalCasos); let h = getPolynomialRegression(l, 2), u = getExponentialRegression(r); drawCasosPorDiaChart(o, t, h), drawCasosAcumuladosChart(o, a, u), drawObitosPorDiaChart(o, e, i), drawObitosAcumuladosChart(o, n, s) } }) } function drawCasosPorDiaChart(o, t, a) { $("#casosPorDiaChart").length && (ctxLine = document.getElementById("casosPorDiaChart").getContext("2d"), optionsLine = { scales: { yAxes: [{ scaleLabel: { display: !0, labelString: "Nº de casos" } }] }, annotation: { annotations: [{ drawTime: "afterDatasetsDraw", id: "hline", type: "line", mode: "vertical", scaleID: "x-axis-0", value: "07/05/2020", borderColor: "rgba(120,120,120,0.7)", borderWidth: 1.5, label: { position: "center", yAdjust: 60, xAdjust: -30, fontSize: 10, backgroundColor: "rgba(255,80,112,0.9)", content: "Lockdown", enabled: !0 } }] } }, optionsLine.maintainAspectRatio = !($(window).width() < width_threshold), configLine = { type: "bar", data: { labels: o, datasets: [{ label: "Total", data: t, fill: !1, borderColor: "rgb(75, 192, 192,0.8)", backgroundColor: "rgb(75, 192, 192,0.8)", lineTension: .1 }, { label: "Tendência*", data: a, fill: !1, borderColor: "rgba(255,99,132,1)", backgroundColor: "rgba(255,99,132,1)", lineTension: .1, type: "line" }] }, options: optionsLine }, lineChart = new Chart(ctxLine, configLine)) } function drawObitosPorDiaChart(o, t, a) { $("#obitosPorDiaChart").length && (ctxLine = document.getElementById("obitosPorDiaChart").getContext("2d"), optionsLine = { scales: { yAxes: [{ scaleLabel: { display: !0, labelString: "Nº de óbitos" } }] } }, optionsLine.maintainAspectRatio = !($(window).width() < width_threshold), configLine = { type: "line", data: { labels: o, datasets: [{ label: "Covid-19", data: t, fill: !1, borderColor: "rgb(75, 192, 192, 1)", backgroundColor: "rgb(75, 192, 192, 1)", lineTension: .1 }, { label: "SRAG**", data: a, fill: !1, borderColor: "rgba(135, 135, 135,1)", backgroundColor: "rgba(135, 135, 135,1)", lineTension: .1 }] }, options: optionsLine }, lineChart = new Chart(ctxLine, configLine)) } function drawCasosAcumuladosChart(o, t, a) { $("#casosAcumuladosChart").length && (ctxLine = document.getElementById("casosAcumuladosChart").getContext("2d"), optionsLine = { scales: { yAxes: [{ scaleLabel: { display: !0, labelString: "Nº de casos" } }] }, annotation: { annotations: [{ drawTime: "afterDatasetsDraw", id: "hline2", type: "line", mode: "vertical", scaleID: "x-axis-0", value: "07/05/2020", borderColor: "rgba(120,120,120,0.7)", borderWidth: 1.5, label: { position: "center", yAdjust: 60, xAdjust: -30, fontSize: 10, backgroundColor: "rgba(255,80,112,0.9)", content: "Lockdown", enabled: !0 } }] } }, optionsLine.maintainAspectRatio = !($(window).width() < width_threshold), configLine = { type: "line", data: { labels: o, datasets: [{ label: "Total", data: t, fill: !1, borderColor: "rgb(75, 192, 192, 0.8)", backgroundColor: "rgb(75, 192, 192, 0.8)", lineTension: .1 }, { label: "Tendência*", data: a, fill: !1, borderColor: "rgba(255,99,132,1)", backgroundColor: "rgba(255,99,132,1)", lineTension: .1 }] }, options: optionsLine }, lineChart = new Chart(ctxLine, configLine)) } function drawObitosAcumuladosChart(o, t, a) { $("#obitosAcumuladosChart").length && (ctxLine = document.getElementById("obitosAcumuladosChart").getContext("2d"), optionsLine = { scales: { yAxes: [{ scaleLabel: { display: !0, labelString: "Nº de óbitos" } }] } }, optionsLine.maintainAspectRatio = !($(window).width() < width_threshold), configLine = { type: "line", data: { labels: o, datasets: [{ label: "Covid-19", data: t, fill: !1, borderColor: "rgb(75, 192, 192)", backgroundColor: "rgb(75, 192, 192)", lineTension: .1 }, { label: "SRAG**", data: a, fill: !1, borderColor: "rgba(135, 135, 135,1)", backgroundColor: "rgba(135, 135, 135,1)", lineTension: .1 }] }, options: optionsLine }, lineChart = new Chart(ctxLine, configLine)) } function updateChartOptions() { $(window).width() < width_threshold ? optionsLine && (optionsLine.maintainAspectRatio = !1) : optionsLine && (optionsLine.maintainAspectRatio = !0) } function ajusteDataHora(o) { var t = o.dayOfMonth, a = o.monthValue, e = o.year, n = o.hour, i = o.minute; if (t < 10 && (t = "0" + t), a < 10 && (a = "0" + a), n < 10 && (n = "0" + n), i < 10 && (minute = "0" + i), null == n && null == i) var s = t + "/" + a + "/" + e; else s = t + "/" + a + "/" + e + " " + n + ":" + i; return s }